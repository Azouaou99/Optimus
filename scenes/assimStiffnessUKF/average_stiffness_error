# load error rate data
errorRate = fopen("/home/sergei/Source_code/Sofa_development/Optimus/scenes/assimStiffnessUKF/measurements/stiffnessError.txt");


timeLine = [];
errorRateLine = [];
currentTime = 0.01;


# read data from file and parse input string
currentLine = fgets(errorRate);
averageError = 0.0;
averagingCoef = 0;
while (!feof(errorRate))
    currentLine = fgets(errorRate);
    tokens = strsplit(currentLine);
    time = tokens(1,1);

    # if needed start new time iteration
    if (abs(str2double(time) - currentTime) > 1e-05)
        timeLine = [timeLine, currentTime];
        currentTime = str2double(time);
        averageError = averageError / averagingCoef;
        errorRateLine = [errorRateLine, averageError];
        averageError = 0.0;
        averagingCoef = 0;
    endif

    index = 2;
    while (index < size(tokens,2))
        if (strcmp(tokens(1,index), "average") == 1)
            averageError = averageError + str2double(tokens(1,index + 1));
            averagingCoef = averagingCoef + 1;
            break;
        endif
        index = index + 1;
    endwhile
endwhile


# finish last iteration
timeLine = [timeLine, currentTime];
currentTime = time;
averageError = averageError / averagingCoef;
errorRateLine = [errorRateLine, averageError];

iterationLine = timeLine .* 100;
figure(100),
plot(iterationLine, errorRateLine, "linewidth", 4)
title("average stiffness error rate", "fontsize", 36)

